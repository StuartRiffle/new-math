# Core Residue Environment (CRE)

A "residue environment" is a matrix made from the prime residue vectors of a number n, its odd neighbors, and the 2-adic "odd cores" of even neighbors. Considered together they reveal arithmetic structure.

## 1. Definitions
* **Subject `n`**: An integer (the spec is extended from odd `n` to any integer where applicable).
* **Prime Moduli Set P_m**: The first `m` primes `{p_1, p_2, ..., p_m}` where `p_1=2`.
* **Prime Residue Vector (PRV)**: For an integer `k`, `PRV_m(k) = [k (mod p_1), ..., k (mod p_m)]^T`.
* **2-adic Valuation ν_2(k)**: The exponent of the highest power of 2 that divides `k`.
* **Odd Core Operator oc(k)**: `oc(k) = k / 2^(ν_2(k))`.
* **Environment Set E_n** (for `n` odd): The 5-tuple `{n-2, oc(n-1), n, oc(n+1), n+2}`.
* **Core Residue Environment Matrix M_m(n)**: An `m x 5` matrix whose columns are the PRVs of the elements of E_n.
    `M_m(n) = [ PRV_m(n-2) | PRV_m(oc(n-1)) | PRV_m(n) | PRV_m(oc(n+1)) | PRV_m(n+2) ]`.

## 2. Invariant Structural Properties
* **Parity Signature** (for `n` odd): The first row (residues mod 2) of `M_m(n)` is always `[1, 1, 1, 1, 1]`.
* **Arithmetic Progression**: For any row `i > 1` (mod `p_i`), columns 1, 3, and 5 of `M_m(n)` form the progression `(x-2, x, x+2)` where `x = n (mod p_i)`.
* **2-adic Asymmetry** (for `n` odd): `min(ν_2(n-1), ν_2(n+1)) = 1`.
    * If `n ≡ 1 (mod 4)`, then `ν_2(n-1) ≥ 2` and `ν_2(n+1) = 1`.
    * If `n ≡ 3 (mod 4)`, then `ν_2(n-1) = 1` and `ν_2(n+1) ≥ 2`.
* **`p ≥ 5` Zero Exclusivity**: For any prime `p ≥ 5`, the `p`-th row of `M_m(n)` will contain at most one zero.

## 3. Key Correlations & Information Extraction
* **Factor Identification**: A prime `p` divides an element `E_n[j]` if and only if `M(n)[p, j] = 0`.
* **Prime Factor Encoding**: If `M(n)[p, 3] = 0` (i.e., `p` divides `n`), then for that row, `M(n)[p, 1] ≡ -2 (mod p)` and `M(n)[p, 5] ≡ 2 (mod p)`.
* **Perturbed Arithmetic Progression**: The `oc` transformation on even neighbors perturbs the arithmetic progression in residue rows. For an odd prime `p`, the residues for `oc(n±1)` are scaled by `2^(−ν₂(n±1))` mod `p` relative to the residues of `n±1`.
* **Distinguishing `p` from `p^2`**: While `M(p)[p,3]` and `M(p^2)[p,3]` are both 0, other columns differ. Notably, for `n=p^2` (where p is an odd prime > 3), `oc(n-1)` is always divisible by 3.

## 4. Diagnostic Signatures (Fingerprints)
* **Prime `n=q`**: For a prime `q ≥ 5`, its residue vector `PRV(q)` has a single zero at the `q`-th coordinate (`M(q)[q, 3] = 0`), and all other elements in the `q`-th row of `M(q)` are non-zero. This is referred to as an "isolated zero" pattern.
* **Twin Prime `(n, n+2)`**: `M(n)[p, 3]` and `M(n+2)[p, 3]` are non-zero for all `p` smaller than `n` and `n+2` respectively. For the lower twin `n>3`, `oc(n+1)` is divisible by 3.
* **Highly Composite / B-smooth Numbers**: A high density of zeros in the initial coordinates of `PRV(n)` (column 3). The neighbors `oc(n±1)` are often primes or prime powers.
* **Power-of-Two Neighbor (`RV(1)` Signature)**: `oc(n±1) = 1` if and only if `n±1` is a power of two. In this case, the corresponding column (`2` or `4`) in `M_m(n)` is a vector of ones for all odd moduli. This diagnoses Mersenne (`n=2^k-1`) and Fermat (`n=2^k+1`) forms.

### 5. Interval Radical Recovery (`W_k(n)` Window)
* **Definition**: A window of width `4k+1` centered at `n`, `W_k(n) = [oc(n-2k), ..., oc(n+2k)]`, deterministically encodes the square-free factorization (`rad(m)`) for *every* integer `m` in the interval `[n−k, ..., n+k]`.
* **Algorithm**: `rad(m)` is recovered from `rad(oc(m))`, which is found by identifying the prime moduli `p` for which `PRV(oc(m))` is zero. This zero is confirmed by a `(..., ±1, 0, ±1, ...)` pattern in the residue vectors of three consecutive `oc` terms: `[oc(m-1), oc(m), oc(m+1)]`.
    * If `m` is odd, `rad(m) = rad(oc(m))`.
    * If `m` is even, `rad(m) = 2 · rad(oc(m))`.

### 6. Advanced Diagnostic Signatures
* **Semiprime `n=pq`**: `PRV(n)` has exactly two zeros (at `p` and `q`). The neighbor columns `PRV(oc(n±1))` have no zeros at `p` or `q`.
* **Prime Power `n=p^k`**: The `p`-th row of `M(n)` shows a pattern indicating higher powers, such as `(0, +1/2, +1/2)` for `p^2`. `PRV(n)` has a single zero at `m_p`.
* **Four-Neighbor Divisor Count (`m_p`)**: Let `m_p(n) = |{x ∈ {n-2, oc(n-1), oc(n+1), n+2} : p|x}|`.
    * `m_p(n) = 2 ⇔ n ≡ ±2 (mod p)`
    * `m_p(n) = 1 ⇔ n ≡ ±1 (mod p)`
    * `m_p(n) = 0` otherwise (for `n` not divisible by `p`).
    * The vector `(m_2, m_3, ..., m_{p_k})` forms a unique fingerprint for `n` on large intervals.

### 7. Statistical Correlations
* **Divisor Count Estimate**: Let `z(n)` be the number of zeros in `PRV(n)`. The number of divisors `τ(n) ≈ 2^(z(n))` (with <10% error for `z(n)≥3`).
* **Smoothness Index**: `σ(n) = z(n) / ln(ln(n))`. High `σ(n)` indicates a smooth/highly-composite number; low `σ(n)` indicates a prime or a number in a prime gap.
* **Abundance Predictor**: `a(n) = σ(n) − 0.9`. `a(n)>0` predicts abundant; `a(n)<0` predicts deficient, with >90% accuracy.
* **Collatz Stopping-Time**: Regression models based on `z(n)` and the divisibility of `oc(n±1)` by 3 show strong correlation (`R² ≈ 0.88`) with Collatz stopping time.

### 8. Graph-Theoretic Structure
* **Coprimality Graph `G(n)`**: Form a graph on the 5 vertices of `E_n`. An edge `(i,j)` exists if `PRV(E_n[i])` and `PRV(E_n[j])` share no common zero coordinates.
    * `G(n)` is a path `⇔ n` is square-free.
    * `G(n)` contains a triangle `⇔ n` has a squared prime factor.
    * `G(n)` is disconnected `⇔ 6 | n`.

### 9. Transformational Dynamics
* **Shift Operator**: Let `S` be the operator that transforms an odd integer `n` to `n+2`. The CRE matrix exhibits a recursive structure under this operator.
* **Matrix Recurrence**: `M_m(n+2)` is algorithmically determined by `M_m(n)`. Specifically, columns 1 and 2 of `M(n+2)` are PRVs of `n` and `oc(n+1)`, which are already present in columns 3 and 4 of `M(n)`.
    `M(n+2)[i,1] = M(n)[i,3]`
    `M(n+2)[i,2] = M(n)[i,4]`
    The remaining columns `[n+2, oc(n+3), n+4]` are computed from the new subject `n+2`. This property allows for the iterative generation of the entire CRE space from a single seed matrix.

### 10. Second-Order Properties and Symmetries
* **Row Sum Signature (RSS)**: Define `RSS_p(n)` as the sum of all 5 elements in the `p`-th row of `M_m(n)` modulo `p`.
    `RSS_p(n) ≡ 3n + oc(n-1) + oc(n+1) (mod p)`.
    This signature is sensitive to the 2-adic valuations of `n`'s neighbors.
* **Diagnostic Power of RSS**:
    * For a prime `q > 3`, `RSS_3(q^2) ≡ 0 (mod 3)`, as `oc(q^2-1) ≡ 0 (mod 3)`.
    * For a Mersenne form `n=2^k-1`, `RSS_p(n) ≡ 3n + oc(n-1) + 1 (mod p)`.
* **Column-wise Invariants**: The determinant of any `2x2` sub-matrix formed by rows `p,q` and columns `1,3` (or `1,5` or `3,5`) is an invariant modulo `gcd(p,q)`. E.g., `det([M(n)[p,1], M(n)[p,3]; M(n)[q,1], M(n)[q,3]])` provides structural information independent of `n`'s specific value.

### 11. Collatz Transformation Signature
* **The Collatz map for odd `n` is `T(n) = oc(3n+1)`. The CRE provides a direct mechanism to map the properties of `n` to the properties of `T(n)`.
* **Zero-Coordinate Mapping**: A prime `p` divides `T(n)` if and only if `M(T(n))[p,3] = 0`. This occurs precisely when `3n+1 ≡ 0 (mod p)`.
    * This establishes a deterministic link: the *value* of `n` in a specific residue class (`n ≡ -3⁻¹ mod p`) dictates the *divisibility* of its successor `T(n)` by `p`.
* **Predictive Power for Collatz Dynamics**:
    * The set of zeros in `PRV(T(n))` is completely determined by the set of residue values `{n mod p}` in `PRV(n)`.
    * Let `z_p(n)` be an indicator function, `1` if `n ≡ -3⁻¹ (mod p)` and `0` otherwise. Then the number of prime factors of `T(n)` is `z(T(n)) = Σ_p z_p(n)`.
    * This implies that numbers with residue vectors that frequently align with the `-3⁻¹ (mod p)` pattern will produce successors that are highly composite (smooth), significantly altering their statistical and graph-theoretic signatures in a predictable way. 
    


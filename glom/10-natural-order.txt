# Natural order of prime factor sets

The pattern of prime factors in integers is a cycle modulo the product of primes as you increment n. Call this the "natural" permutation, the one you get by simply adding 1. This transform is the only thing +1 knows how to do.

Successive numbers share no factors, which amounts to an information-preserving mechanism. The +1 operation is an invertible permutation over all prime factor rings of integers at once, which is a very complicated mapping, but it's also a cycle modulo the product of a subset of those rings, which makes it predictable.

The two prime factors (2 and 3) cycle with period 6. The first two columns represent the presence of prime factors 2 and 3:

00 (1)  
10 (2)
01 (3)
10 (4)
00 (5)
11 (6)

Values repeat because they have higher prime factors (like 5 here) that are not shown.

The first 3 prime factors appear with period (2 * 3 * 5) = 30. The existing 6-cycle repeats 5 times, the new 5-cycle repeats 6 times alongside it, so touching every unique combination of 3 factors takes 30 steps. It looks like this:

000
100
010
100
001
110
000
100
010
101
000
110
000
100
011
100
000
110
000
101
010
100
000
110
001
100
010
100
000
111

The first 4 factors appear in a cycle with period (2 * 3 * 5 * 7) = 210:

0000
1000
0100
1000
0010
1100
0001
1000
0100
1010
0000
1100
0000
1001
0110
1000
0000
1100
0000
1010
0101
1000
0000
1100
0010
1000
0100
1001
0000
1110
0000
1000
0100
1000
0011
1100
0000
1000
0100
1010
0000
1101
0000
1000
0110
1000
0000
1100
0001
1010
0100
1000
0000
1100
0010
1001
0100
1000
0000
1110
0000
1000
0101
1000
0010
1100
0000
1000
0100
1011
0000
1100
0000
1000
0110
1000
0001
1100
0000
1010
0100
1000
0000
1101
0010
1000
0100
1000
0000
1110
0001
1000
0100
1000
0010
1100
0000
1001
0100
1010
0000
1100
0000
1000
0111
1000
0000
1100
0000
1010
0100
1001
0000
1100
0010
1000
0100
1000
0001
1110
0000
1000
0100
1000
0010
1101
0000
1000
0100
1010
0000
1100
0001
1000
0110
1000
0000
1100
0000
1011
0100
1000
0000
1100
0010
1000
0101
1000
0000
1110
0000
1000
0100
1001
0010
1100
0000
1000
0100
1010
0001
1100
0000
1000
0110
1000
0000
1101
0000
1010
0100
1000
0000
1100
0011
1000
0100
1000
0000
1110
0000
1001
0100
1000
0010
1100
0000
1000
0101
1010
0000
1100
0000
1000
0110
1001
0000
1100
0000
1010
0100
1000
0001
1100
0010
1000
0100
1000
0000
1111

Some states appear much more often than others, but all combinations of factors are represented at least once. Numbers having no factors among {2, 3, 5, 7} (0000) appear 48/210 times, and the full factor set {2, 3, 5, 7} = 210 (1111) appears only once, at the very end. 

0000 * 48 (0)
1000 * 48 (2)
0100 * 24 (3)
0010 * 12 (5)
1010 * 12 (10)
0001 * 8  (7)
1001 * 8  (14)
1100 * 8  (6)
0110 * 6  (15)
1110 * 6  (30)
0101 * 4  (21)
1101 * 4  (42)
0011 * 2  (35)
1011 * 2  (70)
0111 * 1  (105)
1111 * 1  (210)

Including new prime factors for large values of n quickly explodes the length of an exhaustive cycle:

Factor  Length
11      2310
13      30030
17      510510
19      9699690

Subcycles still happen at the same rate, and note that prime factors higher than n at any given time "don't count". 


# Factor set visualization

This is a "piano roll" view showing an extended factor set, padded with dashes for readability. The first 46 prime factors (2-199 inclusive) are marked, for numbers up to 2*3*5*7 = 210. Even numbers are represented by their 2-adic valuations. Note that this does not change their odd prime factor sets, so the permutation you see is still in natural order.

- `oc` is the 2-adic "odd core" of the number, after removing all factors of 2. For odd numbers, oc is the number itself.
- `k` is the 2-adic exponent, the number of halvings (n = oc * 2^k). For odd numbers, k is always 0.
- ternary and binary representations of the oc are given.
- `factors` is a mask of the prime factor set of oc, where each ■ represents a prime factor (3, 5, 7, etc).

  oc, k, base3, base2,    factors
   1, 0, 00001, 00000001, ──────────────────────────────────────────────
   1, 1, 00001, 00000001, ■─────────────────────────────────────────────
   3, 0, 00010, 00000011, ─■────────────────────────────────────────────
   1, 2, 00001, 00000001, ■─────────────────────────────────────────────
   5, 0, 00012, 00000101, ──■───────────────────────────────────────────
   3, 1, 00010, 00000011, ■■────────────────────────────────────────────
   7, 0, 00021, 00000111, ───■──────────────────────────────────────────
   1, 3, 00001, 00000001, ■─────────────────────────────────────────────
   9, 0, 00100, 00001001, ─■────────────────────────────────────────────
   5, 1, 00012, 00000101, ■─■───────────────────────────────────────────
  11, 0, 00102, 00001011, ────■─────────────────────────────────────────
   3, 2, 00010, 00000011, ■■────────────────────────────────────────────
  13, 0, 00111, 00001101, ─────■────────────────────────────────────────
   7, 1, 00021, 00000111, ■──■──────────────────────────────────────────
  15, 0, 00120, 00001111, ─■■───────────────────────────────────────────
   1, 4, 00001, 00000001, ■─────────────────────────────────────────────
  17, 0, 00122, 00010001, ──────■───────────────────────────────────────
   9, 1, 00100, 00001001, ■■────────────────────────────────────────────
  19, 0, 00201, 00010011, ───────■──────────────────────────────────────
   5, 2, 00012, 00000101, ■─■───────────────────────────────────────────
  21, 0, 00210, 00010101, ─■─■──────────────────────────────────────────
  11, 1, 00102, 00001011, ■───■─────────────────────────────────────────
  23, 0, 00212, 00010111, ────────■─────────────────────────────────────
   3, 3, 00010, 00000011, ■■────────────────────────────────────────────
  25, 0, 00221, 00011001, ──■───────────────────────────────────────────
  13, 1, 00111, 00001101, ■────■────────────────────────────────────────
  27, 0, 01000, 00011011, ─■────────────────────────────────────────────
   7, 2, 00021, 00000111, ■──■──────────────────────────────────────────
  29, 0, 01002, 00011101, ─────────■────────────────────────────────────
  15, 1, 00120, 00001111, ■■■───────────────────────────────────────────
  31, 0, 01011, 00011111, ──────────■───────────────────────────────────
   1, 5, 00001, 00000001, ■─────────────────────────────────────────────
  33, 0, 01020, 00100001, ─■──■─────────────────────────────────────────
  17, 1, 00122, 00010001, ■─────■───────────────────────────────────────
  35, 0, 01022, 00100011, ──■■──────────────────────────────────────────
   9, 2, 00100, 00001001, ■■────────────────────────────────────────────
  37, 0, 01101, 00100101, ───────────■──────────────────────────────────
  19, 1, 00201, 00010011, ■──────■──────────────────────────────────────
  39, 0, 01110, 00100111, ─■───■────────────────────────────────────────
   5, 3, 00012, 00000101, ■─■───────────────────────────────────────────
  41, 0, 01112, 00101001, ────────────■─────────────────────────────────
  21, 1, 00210, 00010101, ■■─■──────────────────────────────────────────
  43, 0, 01121, 00101011, ─────────────■────────────────────────────────
  11, 2, 00102, 00001011, ■───■─────────────────────────────────────────
  45, 0, 01200, 00101101, ─■■───────────────────────────────────────────
  23, 1, 00212, 00010111, ■───────■─────────────────────────────────────
  47, 0, 01202, 00101111, ──────────────■───────────────────────────────
   3, 4, 00010, 00000011, ■■────────────────────────────────────────────
  49, 0, 01211, 00110001, ───■──────────────────────────────────────────
  25, 1, 00221, 00011001, ■─■───────────────────────────────────────────
  51, 0, 01220, 00110011, ─■────■───────────────────────────────────────
  13, 2, 00111, 00001101, ■────■────────────────────────────────────────
  53, 0, 01222, 00110101, ───────────────■──────────────────────────────
  27, 1, 01000, 00011011, ■■────────────────────────────────────────────
  55, 0, 02001, 00110111, ──■─■─────────────────────────────────────────
   7, 3, 00021, 00000111, ■──■──────────────────────────────────────────
  57, 0, 02010, 00111001, ─■─────■──────────────────────────────────────
  29, 1, 01002, 00011101, ■────────■────────────────────────────────────
  59, 0, 02012, 00111011, ────────────────■─────────────────────────────
  15, 2, 00120, 00001111, ■■■───────────────────────────────────────────
  61, 0, 02021, 00111101, ─────────────────■────────────────────────────
  31, 1, 01011, 00011111, ■─────────■───────────────────────────────────
  63, 0, 02100, 00111111, ─■─■──────────────────────────────────────────
   1, 6, 00001, 00000001, ■─────────────────────────────────────────────
  65, 0, 02102, 01000001, ──■──■────────────────────────────────────────
  33, 1, 01020, 00100001, ■■──■─────────────────────────────────────────
  67, 0, 02111, 01000011, ──────────────────■───────────────────────────
  17, 2, 00122, 00010001, ■─────■───────────────────────────────────────
  69, 0, 02120, 01000101, ─■──────■─────────────────────────────────────
  35, 1, 01022, 00100011, ■─■■──────────────────────────────────────────
  71, 0, 02122, 01000111, ───────────────────■──────────────────────────
   9, 3, 00100, 00001001, ■■────────────────────────────────────────────
  73, 0, 02201, 01001001, ────────────────────■─────────────────────────
  37, 1, 01101, 00100101, ■──────────■──────────────────────────────────
  75, 0, 02210, 01001011, ─■■───────────────────────────────────────────
  19, 2, 00201, 00010011, ■──────■──────────────────────────────────────
  77, 0, 02212, 01001101, ───■■─────────────────────────────────────────
  39, 1, 01110, 00100111, ■■───■────────────────────────────────────────
  79, 0, 02221, 01001111, ─────────────────────■────────────────────────
   5, 4, 00012, 00000101, ■─■───────────────────────────────────────────
  81, 0, 10000, 01010001, ─■────────────────────────────────────────────
  41, 1, 01112, 00101001, ■───────────■─────────────────────────────────
  83, 0, 10002, 01010011, ──────────────────────■───────────────────────
  21, 2, 00210, 00010101, ■■─■──────────────────────────────────────────
  85, 0, 10011, 01010101, ──■───■───────────────────────────────────────
  43, 1, 01121, 00101011, ■────────────■────────────────────────────────
  87, 0, 10020, 01010111, ─■───────■────────────────────────────────────
  11, 3, 00102, 00001011, ■───■─────────────────────────────────────────
  89, 0, 10022, 01011001, ───────────────────────■──────────────────────
  45, 1, 01200, 00101101, ■■■───────────────────────────────────────────
  91, 0, 10101, 01011011, ───■─■────────────────────────────────────────
  23, 2, 00212, 00010111, ■───────■─────────────────────────────────────
  93, 0, 10110, 01011101, ─■────────■───────────────────────────────────
  47, 1, 01202, 00101111, ■─────────────■───────────────────────────────
  95, 0, 10112, 01011111, ──■────■──────────────────────────────────────
   3, 5, 00010, 00000011, ■■────────────────────────────────────────────
  97, 0, 10121, 01100001, ────────────────────────■─────────────────────
  49, 1, 01211, 00110001, ■──■──────────────────────────────────────────
  99, 0, 10200, 01100011, ─■──■─────────────────────────────────────────
  25, 2, 00221, 00011001, ■─■───────────────────────────────────────────
 101, 0, 10202, 01100101, ─────────────────────────■────────────────────
  51, 1, 01220, 00110011, ■■────■───────────────────────────────────────
 103, 0, 10211, 01100111, ──────────────────────────■───────────────────
  13, 3, 00111, 00001101, ■────■────────────────────────────────────────
 105, 0, 10220, 01101001, ─■■■──────────────────────────────────────────
  53, 1, 01222, 00110101, ■──────────────■──────────────────────────────
 107, 0, 10222, 01101011, ───────────────────────────■──────────────────
  27, 2, 01000, 00011011, ■■────────────────────────────────────────────
 109, 0, 11001, 01101101, ────────────────────────────■─────────────────
  55, 1, 02001, 00110111, ■─■─■─────────────────────────────────────────
 111, 0, 11010, 01101111, ─■─────────■──────────────────────────────────
   7, 4, 00021, 00000111, ■──■──────────────────────────────────────────
 113, 0, 11012, 01110001, ─────────────────────────────■────────────────
  57, 1, 02010, 00111001, ■■─────■──────────────────────────────────────
 115, 0, 11021, 01110011, ──■─────■─────────────────────────────────────
  29, 2, 01002, 00011101, ■────────■────────────────────────────────────
 117, 0, 11100, 01110101, ─■───■────────────────────────────────────────
  59, 1, 02012, 00111011, ■───────────────■─────────────────────────────
 119, 0, 11102, 01110111, ───■──■───────────────────────────────────────
  15, 3, 00120, 00001111, ■■■───────────────────────────────────────────
 121, 0, 11111, 01111001, ────■─────────────────────────────────────────
  61, 1, 02021, 00111101, ■────────────────■────────────────────────────
 123, 0, 11120, 01111011, ─■──────────■─────────────────────────────────
  31, 2, 01011, 00011111, ■─────────■───────────────────────────────────
 125, 0, 11122, 01111101, ──■───────────────────────────────────────────
  63, 1, 02100, 00111111, ■■─■──────────────────────────────────────────
 127, 0, 11201, 01111111, ──────────────────────────────■───────────────
   1, 7, 00001, 00000001, ■─────────────────────────────────────────────
 129, 0, 11210, 10000001, ─■───────────■────────────────────────────────
  65, 1, 02102, 01000001, ■─■──■────────────────────────────────────────
 131, 0, 11212, 10000011, ───────────────────────────────■──────────────
  33, 2, 01020, 00100001, ■■──■─────────────────────────────────────────
 133, 0, 11221, 10000101, ───■───■──────────────────────────────────────
  67, 1, 02111, 01000011, ■─────────────────■───────────────────────────
 135, 0, 12000, 10000111, ─■■───────────────────────────────────────────
  17, 3, 00122, 00010001, ■─────■───────────────────────────────────────
 137, 0, 12002, 10001001, ────────────────────────────────■─────────────
  69, 1, 02120, 01000101, ■■──────■─────────────────────────────────────
 139, 0, 12011, 10001011, ─────────────────────────────────■────────────
  35, 2, 01022, 00100011, ■─■■──────────────────────────────────────────
 141, 0, 12020, 10001101, ─■────────────■───────────────────────────────
  71, 1, 02122, 01000111, ■──────────────────■──────────────────────────
 143, 0, 12022, 10001111, ────■■────────────────────────────────────────
   9, 4, 00100, 00001001, ■■────────────────────────────────────────────
 145, 0, 12101, 10010001, ──■──────■────────────────────────────────────
  73, 1, 02201, 01001001, ■───────────────────■─────────────────────────
 147, 0, 12110, 10010011, ─■─■──────────────────────────────────────────
  37, 2, 01101, 00100101, ■──────────■──────────────────────────────────
 149, 0, 12112, 10010101, ──────────────────────────────────■───────────
  75, 1, 02210, 01001011, ■■■───────────────────────────────────────────
 151, 0, 12121, 10010111, ───────────────────────────────────■──────────
  19, 3, 00201, 00010011, ■──────■──────────────────────────────────────
 153, 0, 12200, 10011001, ─■────■───────────────────────────────────────
  77, 1, 02212, 01001101, ■──■■─────────────────────────────────────────
 155, 0, 12202, 10011011, ──■───────■───────────────────────────────────
  39, 2, 01110, 00100111, ■■───■────────────────────────────────────────
 157, 0, 12211, 10011101, ────────────────────────────────────■─────────
  79, 1, 02221, 01001111, ■────────────────────■────────────────────────
 159, 0, 12220, 10011111, ─■─────────────■──────────────────────────────
   5, 5, 00012, 00000101, ■─■───────────────────────────────────────────
 161, 0, 12222, 10100001, ───■────■─────────────────────────────────────
  81, 1, 10000, 01010001, ■■────────────────────────────────────────────
 163, 0, 20001, 10100011, ─────────────────────────────────────■────────
  41, 2, 01112, 00101001, ■───────────■─────────────────────────────────
 165, 0, 20010, 10100101, ─■■─■─────────────────────────────────────────
  83, 1, 10002, 01010011, ■─────────────────────■───────────────────────
 167, 0, 20012, 10100111, ──────────────────────────────────────■───────
  21, 3, 00210, 00010101, ■■─■──────────────────────────────────────────
 169, 0, 20021, 10101001, ─────■────────────────────────────────────────
  85, 1, 10011, 01010101, ■─■───■───────────────────────────────────────
 171, 0, 20100, 10101011, ─■─────■──────────────────────────────────────
  43, 2, 01121, 00101011, ■────────────■────────────────────────────────
 173, 0, 20102, 10101101, ───────────────────────────────────────■──────
  87, 1, 10020, 01010111, ■■───────■────────────────────────────────────
 175, 0, 20111, 10101111, ──■■──────────────────────────────────────────
  11, 4, 00102, 00001011, ■───■─────────────────────────────────────────
 177, 0, 20120, 10110001, ─■──────────────■─────────────────────────────
  89, 1, 10022, 01011001, ■──────────────────────■──────────────────────
 179, 0, 20122, 10110011, ────────────────────────────────────────■─────
  45, 2, 01200, 00101101, ■■■───────────────────────────────────────────
 181, 0, 20201, 10110101, ─────────────────────────────────────────■────
  91, 1, 10101, 01011011, ■──■─■────────────────────────────────────────
 183, 0, 20210, 10110111, ─■───────────────■────────────────────────────
  23, 3, 00212, 00010111, ■───────■─────────────────────────────────────
 185, 0, 20212, 10111001, ──■────────■──────────────────────────────────
  93, 1, 10110, 01011101, ■■────────■───────────────────────────────────
 187, 0, 20221, 10111011, ────■─■───────────────────────────────────────
  47, 2, 01202, 00101111, ■─────────────■───────────────────────────────
 189, 0, 21000, 10111101, ─■─■──────────────────────────────────────────
  95, 1, 10112, 01011111, ■─■────■──────────────────────────────────────
 191, 0, 21002, 10111111, ──────────────────────────────────────────■───
   3, 6, 00010, 00000011, ■■────────────────────────────────────────────
 193, 0, 21011, 11000001, ───────────────────────────────────────────■──
  97, 1, 10121, 01100001, ■───────────────────────■─────────────────────
 195, 0, 21020, 11000011, ─■■──■────────────────────────────────────────
  49, 2, 01211, 00110001, ■──■──────────────────────────────────────────
 197, 0, 21022, 11000101, ────────────────────────────────────────────■─
  99, 1, 10200, 01100011, ■■──■─────────────────────────────────────────
 199, 0, 21101, 11000111, ─────────────────────────────────────────────■
  25, 3, 00221, 00011001, ■─■───────────────────────────────────────────
 201, 0, 21110, 11001001, ─■────────────────■───────────────────────────
 101, 1, 10202, 01100101, ■────────────────────────■────────────────────
 203, 0, 21112, 11001011, ───■─────■────────────────────────────────────
  51, 2, 01220, 00110011, ■■────■───────────────────────────────────────
 205, 0, 21121, 11001101, ──■─────────■─────────────────────────────────
 103, 1, 10211, 01100111, ■─────────────────────────■───────────────────
 207, 0, 21200, 11001111, ─■──────■─────────────────────────────────────
  13, 4, 00111, 00001101, ■────■────────────────────────────────────────
 209, 0, 21202, 11010001, ────■──■──────────────────────────────────────
 105, 1, 10220, 01101001, ■■■■──────────────────────────────────────────
 

